<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>VoteHive Poll</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet" />
</head>
<body class="bg-white text-gray-800 font-sans">
  <div class="max-w-2xl mx-auto px-4 py-10">
    <h1 id="pollTitle" class="text-3xl font-bold mb-4">Loading poll...</h1>
    <p id="pollCategory" class="text-sm text-gray-500 mb-6"></p>

    <form id="voteForm" class="space-y-4 mb-6"></form>

    <p id="countdown" class="text-sm text-gray-600 mb-4"></p>
    <p id="shareLink" class="text-sm text-indigo-600 break-all"></p>
  </div>

  <script>
    const polls = {
      "startup-vs-enterprise": {
        title: "Which is better: Startup or Enterprise job?",
        category: "Careers",
        options: ["Startup", "Enterprise"],
        endTime: new Date(Date.now() + 2 * 24 * 60 * 60 * 1000).toISOString()
      },
      "ai-future": {
        title: "Will AI create more jobs than it eliminates?",
        category: "Technology",
        options: ["Yes", "No", "Not Sure"],
        endTime: new Date(Date.now() + 1 * 24 * 60 * 60 * 1000).toISOString()
      },
      "real-estate-safe": {
        title: "Which property investment is safer?",
        category: "Real Estate",
        options: ["Off-Plan", "Completed Project", "Land"],
        endTime: new Date(Date.now() + 3 * 24 * 60 * 60 * 1000).toISOString()
      },
      "flat-vs-skeuo": {
        title: "Which design trend is better?",
        category: "Design",
        options: ["Flat Design", "Skeuomorphic Design"],
        endTime: new Date(Date.now() + 4 * 24 * 60 * 60 * 1000).toISOString()
      },
      "global-online-vote": {
        title: "Should global elections allow online voting?",
        category: "Global",
        options: ["Yes", "No", "Only Locally"],
        endTime: new Date(Date.now() + 5 * 24 * 60 * 60 * 1000).toISOString()
      }
    };

    const urlParams = new URLSearchParams(window.location.search);
    const pollId = urlParams.get("id");

    const storedPolls = JSON.parse(localStorage.getItem("customPolls") || "{}");
    const poll = storedPolls[pollId] || polls[pollId];

    const titleEl = document.getElementById("pollTitle");
    const categoryEl = document.getElementById("pollCategory");
    const formEl = document.getElementById("voteForm");
    const countdownEl = document.getElementById("countdown");
    const shareLinkEl = document.getElementById("shareLink");

    if (!poll) {
      titleEl.textContent = "Poll not found.";
      formEl.remove();
    } else {
      titleEl.textContent = poll.title;
      categoryEl.textContent = `Category: ${poll.category}`;
      shareLinkEl.textContent = `${window.location.origin}${window.location.pathname}?id=${pollId}`;

      const endTime = new Date(poll.endTime);
      const now = new Date();
      if (now > endTime) {
        countdownEl.textContent = "Poll closed.";
        formEl.innerHTML = "<p class='text-red-500'>Voting is closed for this poll.</p>";
      } else {
        countdownEl.textContent = `Poll ends on: ${endTime.toLocaleString()}`;
        poll.options.forEach((opt, i) => {
          const label = document.createElement("label");
          label.className = "block border border-gray-300 rounded p-2 cursor-pointer hover:bg-gray-50";
          label.innerHTML = `
            <input type="radio" name="option" value="${opt}" class="mr-2">
            ${opt}
          `;
          formEl.appendChild(label);
        });
        const btn = document.createElement("button");
        btn.type = "submit";
        btn.textContent = "Vote";
        btn.className = "mt-4 bg-indigo-600 text-white px-4 py-2 rounded hover:bg-indigo-700";
        formEl.appendChild(btn);
      }
    }
  </script>
</body>
</html>